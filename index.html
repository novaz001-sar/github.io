<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>å¼€åœº Â· å†œç”°æ‰“åœ°é¼ </title>
  <style>
    :root{
      --bg:#e8f7e0; --bg2:#bde6a1; --card:#ffffff; --text:#102a13;
      --shadow:0 14px 34px rgba(0,0,0,.16); --radius:18px;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),var(--bg2));color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,'PingFang SC','Microsoft Yahei',sans-serif}
    /* å¼€åœºå®¹å™¨ï¼ˆç›–åœ¨æœ€ä¸Šå±‚ï¼‰ */
    .stage{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:10}
    /* å±…ä¸­å¡ç‰‡ */
    .card{width:min(1000px,92vw);aspect-ratio:16/9;background:var(--card);border-radius:var(--radius);
      box-shadow:var(--shadow);overflow:hidden;position:relative}
    /* è§†é¢‘ */
    video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;background:#000}
    /* æ·¡å‡º */
    .fade-out{animation:fade .6s ease forwards}
    @keyframes fade{to{opacity:0;visibility:hidden}}
    /* é¡¶éƒ¨ HUDï¼ˆæ ‡é¢˜ã€é™éŸ³ã€è·³è¿‡ï¼‰ */
    .title{position:absolute;left:12px;top:12px;padding:6px 10px;border-radius:12px;background:rgba(255,255,255,.85);
      backdrop-filter:blur(4px);font-weight:600}
    .hud{position:absolute;right:12px;top:12px;display:flex;gap:8px;z-index:2}
    .btn{padding:8px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.08);cursor:pointer;
      background:rgba(255,255,255,.85);backdrop-filter:blur(4px)}
    .btn:hover{background:#fff}
    /* ç¼“å†²æç¤º */
    .tip{position:absolute;left:12px;bottom:12px;padding:6px 10px;border-radius:12px;background:rgba(255,255,255,.85)}
    /* å¦‚å°†æ¥éœ€è¦ iframe å†…åµŒæ¸¸æˆå¯ç”¨ï¼ˆå½“å‰ä¸æ˜¾ç¤ºï¼‰ */
    #gameFrame{position:fixed;inset:0;border:0;width:100vw;height:100vh;display:none}
  </style>
</head>
<body>
  <div class="stage" id="intro">
    <div class="card">
      <div class="title">ğŸŒ¾ å†œç”°æ‰“åœ°é¼  Â· ä¿æŠ¤å†œåœ°</div>
      <div class="hud">
        <button class="btn" id="btnMute">ğŸ”Š</button>
        <button class="btn" id="btnSkip">è·³è¿‡</button>
      </div>
      <video id="introVideo"
             src="assets_task_.mp4"
             playsinline webkit-playsinline
             preload="auto"
             muted autoplay
             ></video>
      <div class="tip" id="tip">æ­£åœ¨ç¼“å†²è§†é¢‘â€¦ï¼ˆè‹¥æ— å£°ï¼Œç‚¹ä»»æ„å¤„è§£é”å£°éŸ³ï¼‰</div>
    </div>
  </div>

  <!-- è‹¥æƒ³ç•™åœ¨ github.io åŒé¡µå†…åµŒï¼Œå¯åœ¨ä¸‹æ–¹å¯ç”¨ iframe å¹¶æ”¹ go()ï¼›å½“å‰æ–¹æ¡ˆä¸ºæ’­æ”¾å®Œè·³è½¬åˆ° Vercel -->
  <iframe id="gameFrame" src="https://whack-a-mole-game-virid.vercel.app" title="Whack-a-Mole"></iframe>

  <script>
    // ===== åŸºæœ¬å‚æ•° =====
    const DEST = 'https://whack-a-mole-game-virid.vercel.app'; // Vercel æ¸¸æˆåœ°å€
    const url  = new URL(location.href);
    if (url.searchParams.get('skip') === '1') location.replace(DEST); // è°ƒè¯•ç›´è¾¾

    const VIDEO    = document.getElementById('introVideo');
    const INTRO    = document.getElementById('intro');
    const TIP      = document.getElementById('tip');
    const BTN_SKIP = document.getElementById('btnSkip');
    const BTN_MUTE = document.getElementById('btnMute');
    const IFM_GAME = document.getElementById('gameFrame'); // å¤‡ç”¨ï¼šåŒé¡µå†…åµŒ

    // ===== è‡ªåŠ¨æ’­æ”¾ç­–ç•¥ï¼šé»˜è®¤é™éŸ³ï¼Œç”¨æˆ·äº¤äº’åå¯å¼€å£° =====
    function safePlay(){
      const p = VIDEO.play();
      if (p && typeof p.catch === 'function'){
        p.catch(()=> TIP.textContent = 'æµè§ˆå™¨é˜»æ­¢è‡ªåŠ¨æ’­æ”¾ï¼Œè¯·ç‚¹å‡»ç”»é¢æˆ–è·³è¿‡');
      }
    }
    safePlay();

    function updateMuteUI(){ BTN_MUTE.textContent = VIDEO.muted ? 'ğŸ”ˆ' : 'ğŸ”Š'; }
    BTN_MUTE.addEventListener('click', ()=>{
      VIDEO.muted = !VIDEO.muted;
      if (!VIDEO.muted){ VIDEO.volume = 1; safePlay(); }
      updateMuteUI();
    });
    updateMuteUI();

    // ===== ä¸æ»‘è¿›å…¥æ¸¸æˆï¼ˆå½“å‰æ–¹æ¡ˆï¼šè·³è½¬åˆ° Vercelï¼‰ =====
    function go(){
      INTRO.classList.add('fade-out');
      setTimeout(()=>location.replace(DEST), 450);
    }
    VIDEO.addEventListener('ended', go);
    BTN_SKIP.addEventListener('click', go);

    // è½»è§¦/ç‚¹å‡»å³å¯è§£é”å£°éŸ³æˆ–ç»­æ’­
    window.addEventListener('pointerdown', ()=>{ if (VIDEO.paused) safePlay(); }, {passive:true});
    VIDEO.addEventListener('playing', ()=> TIP.style.display = 'none');
  </script>
</body>
</html>
